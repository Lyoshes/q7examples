--- Q7 testcase ---
Q7-vendor: www.xored.com/q7
Format-Version: 1.0
Element-Name: CutPasteInScriptEditor
Tags: scripteditor
External-Reference: 
Element-Type: testcase
Element-Version: 3.0
Contexts: _vux-ED2qEeGit9CrtuY7UA,_k86W8D2qEeGit9CrtuY7UA
Save-Time: 2/10/12 4:38 PM
Id: _8_3WoFPEEeGS0tnq09p7JQ
Testcase-Type: ecl

------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa
Entry-Name: .description
Content-Type: text/plain

1. Open file in editor
2. Select text and press "Cut" in context menu
3. Open the second file and press "Paste" in context menu
4. Make sure that text is copied to the second file and is removed from first file
------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa--
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Entry-Name: .content
Content-Type: text/ecl

get-view "Script Explorer" | get-tree | select "javascript.project/testfolder/testfile.js" | double-click
with [get-editor "testfile.js" | get-text-viewer] {
    set-caret-pos 16 2
    select-range 15 1 22 3
    get-menu Cut | click
    set-caret-pos 15 3
    get-menu Save | click
}
get-view "Script Explorer" | get-tree | select "javascript.project/testfolder/firstfile.js" | double-click
with [get-editor "firstfile.js" | get-text-viewer] {
    set-caret-pos 4 2
    key-type Enter
    get-menu Paste | click
    get-menu Save | click
}
get-editor "firstfile.js" | get-editbox | get-property text | equals "function click(e) {\n"
    + "\t\n"
    + "\t\n}\n"
    + "function checkField(field) \n"
    + "{ \n"
    + "if (field.value == \"\") \n"
    + "help(\"Test Fields\"); \n"
    + "else \n"
    + "help(\"\"); \n"
    + "return true; \n"
    + "}" | verify-true
get-editor "testfile.js" | click
get-editor "testfile.js" | get-editbox | get-property text | equals "function closewindow() {\n"
    + "\tif (document.all) {\n"
    + "\t\tdocument.all.orderwindow.style.visibility=\"hidden\"\n"
    + "\t}\n"
    + "\tif (document.layers) {\n"
    + "\t\tdocument.orderwindow.visibility=\"hidden\"\n"
    + "\t}\n}\n\n"
    + "function help(message) \n"
    + "{ \n"
    + "return true; \n"
    + "}" | verify-true
with [get-editor "testfile.js" | get-text-viewer] {
    set-caret-pos 13 1
    select-range 13 2 10 1
}
get-menu "Edit/Cut" | click
with [get-editor "firstfile.js"] {
    click
    get-text-viewer | key-type Enter
}
get-menu "Edit/Paste" | click
get-button "Save All (M1+M2+S)" | click
get-editor "firstfile.js" | get-editbox | get-property text | contains "function click(e) {\n"
    + "\t\n"
    + "\t\n}\n"
    + "function checkField(field) \n"
    + "{ \n"
    + "if (field.value == \"\") \n"
    + "help(\"Test Fields\"); \n"
    + "else \n"
    + "help(\"\"); \n"
    + "return true; \n"
    + "} \n"
    + "function help(message) \n"
    + "{ \n"
    + "return true; \n"
    + "}" | verify-true
get-editor "testfile.js" | click
get-editor "testfile.js" | get-editbox | get-property text | equals "function closewindow() {\n"
    + "\tif (document.all) {\n"
    + "\t\tdocument.all.orderwindow.style.visibility=\"hidden\"\n"
    + "\t}\n"
    + "\tif (document.layers) {\n"
    + "\t\tdocument.orderwindow.visibility=\"hidden\"\n"
    + "\t}\n"
    + "}" | verify-true
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--
